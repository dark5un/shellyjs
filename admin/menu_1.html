<html>
<head>
<title>Shelly Admin Menu</title>
    <script src="/static/js/jquery-1.7.1.min.js"></script>
    <script src="/static/js/ba-debug.js"></script>
<style type="text/css">
body {
	font-family:verdana,arial,sans-serif;
	font-size:10pt;
	margin:10px;
	background-color:#ff9900;
	}
h3 {
    margin: 0;
}
.moduleDiv {
    margin-bottom: 10px;
}
.moduleName {
    margin-left: 10px;
}
.moduleFunction {
    margin-left: 20px;
}
</style>
    <script lang="javascript">
        var Env = {};
        Env.gModules = {{{modules}}};

        function createModule(name, m)
        {
            debug.info("create module:", name, m);

            // create the module
            var $newModule = $("#moduleTemplate").clone();
            $newModule.attr("moduleName", name);
            $newModule.addClass("module-"+name);
            $newModule.css("display", "block");
            var $moduleName = $newModule.find(".moduleName");
            $moduleName.text(name);

            // list the functions
            for (fkey in m.functions) {
                var $newFunction = $("#functionTemplate").clone();
                var $functionLink = $newFunction.find(".functionLink");
                $functionLink.text(fkey);
                $functionLink.attr("href", "function/"+mkey+"/"+fkey);
                $newFunction.css("display", "block");
                $newModule.append($newFunction);
            }
            $(".moduleList").append($newModule);
        }

        $(init);
        function init()
        {
            for (mkey in Env.gModules) {
                createModule(mkey, Env.gModules[mkey]);
            }
        }
    </script>
</head>
<body>
<h3>Hello {{user}}</h3>
<h3>Functions</h3>
<div class="moduleList">
    <div class="moduleDiv" id="moduleTemplate" style="display:none">
        <div class="moduleName">moduleName</div>
        <div class="moduleFunction" id="functionTemplate" style="display:none">
            <a class="functionLink" href="" target="content">moduleFunction</a>
        </div>
    </div>
</div>
</body>
</html>