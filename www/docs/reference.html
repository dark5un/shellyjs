<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Shelly Server</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- styles -->
    <link href="/common/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/common/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/common/bootstrap/css/docs.css" rel="stylesheet">
    <link href="/common/google-code-prettify/prettify.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="bootstrap/js/html5shiv.js"></script>
    <![endif]-->

    <!-- fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/common/bootstrap/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/common/bootstrap/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/common/bootstrap/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="/common/bootstrap/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="/common/bootstrap/ico/favicon.png">

      <style>
          pre {
              font-size: 10px;
          }
      </style>
  </head>

  <body data-spy="scroll" data-target=".bs-docs-sidebar">
  <%- include nav.html %>

<!-- Subhead
================================================== -->
<header class="jumbotron subhead">
  <div class="container">
    <h1>ShellyJS</h1>
    <p class="lead">Reference</p>
  </div>
</header>

  <div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
      <div class="span3 bs-docs-sidebar">
        <ul class="nav nav-list bs-docs-sidenav">
          <li><a href="#overview"><i class="icon-chevron-right"></i>Configuration</a></li>
          <li><a href="#createApi"><i class="icon-chevron-right"></i>API Format</a></li>
          <li><a href="#testApi"><i class="icon-chevron-right"></i>Request</a></li>
          <li><a href="#addFunction"><i class="icon-chevron-right"></i>Response</a></li>
          <li><a href="#runCluster"><i class="icon-chevron-right"></i>ShDispatch</a></li>
          <li><a href="#useRedis"><i class="icon-chevron-right"></i>ShLoader</a></li>
        </ul>
      </div>
      <div class="span9">


          <!-- Overview
          ================================================== -->
          <section id="overview">
              <div class="page-header">
                  <h1>Configuration</h1>
              </div>

              <h3>Approach</h3>
              <p>Configuration settings are stored at the global scope under the "global.C" object and accessed via "global.C.KEY_NAME"</p>
<pre class="prettyprint linenums">
var sh = require(global.C.BASE_DIR + "/lib/shutil.js");
</pre>
              <p>At startup ShellyJS will look for a directory named "config" in the shellyjs install directory "./node_modes/shellyjs/config"</p>
              <p>This is typically overridden by passing in "CONFIG_DIR" to the shellyjs.start function. </p>
<pre class="prettyprint linenums">
shelly.start({
  CONFIG_DIR: __dirname + "/config"
});
</pre>
              <p>Configuration values are set via the following in priority order:</p>
              <ol>
                  <li>Passed on the command line via "key"="value"</li>
                  <li>Passed as key:values in the first object parameter the shellyjs.start function </li>
                  <li>Set using global.CDEF function in a configuration file (keys.js, os.hostname() + ".js", main.js</li>
              </ol>

              <p>To keep things segmented well you can chain your "main.js" configuration file to the default one like:</p>

<pre class="prettyprint linenums">
global.CDEF("MODULE_CACHE", false);
global.CDEF("CLUSTER_NUM_SOCKET", 1);

// pick up all the other default configs
require(global.C.BASE_DIR + "/config/main.js");
</pre>

              <h3>Settings</h3>

              <table class="table table-striped table-bordered">
                  <thead>
                    <tr><td>Setting</td><td>Default</td><td>Info</td></tr>
                  </thead>
                  <tbody>

                  <tr><td>ADMIN_PORT</td><td>5100</td><td></td>
                  <tr><td>ADMIN_URL</td><td>http:// + DNS_NAME + : + ADMIN_PORT</td><td></td>
                  <tr><td>APP_API_DIR</td><td>BASE_DIR + /example/apis</td><td></td>
                  <tr><td>BASE_DIR</td><td>~/shellyjs</td><td>value is always install directory and cannot be changed</td>
                  <tr><td>CLUSTER</td><td>{
                      "socket": {src: "&ltprocess file&gt", num: &ltnumber to start&gt, args: [&ltarray of args to start with&gt],
                      ...
                      }</td><td>workers created at startup (socket, reset, mailer, ...)</td>
                  <tr><td>CLUSTER_AUTO_GAME_MATCHER</td><td>true</td><td>automatically create a matcher process for any game</td>
                  <tr><td>CLUSTER_NUM_ADMIN</td><td>1</td><td>number of admin web workers</td>
                  <tr><td>CLUSTER_NUM_GAMES</td><td>1</td><td>number of example game web workers</td>
                  <tr><td>CLUSTER_NUM_MAILER</td><td>1</td><td>number of send mailer workers</td>
                  <tr><td>CLUSTER_NUM_MATCHER</td><td>1</td><td>number of player matcher workers per game</td>
                  <tr><td>CLUSTER_NUM_REST</td><td>1</td><td>number of API rest workers</td>
                  <tr><td>CLUSTER_NUM_SOCKET</td><td>1</td><td>number of API websocket workers</td>
                  <tr><td>CLUSTER_NUM_TCP</td><td>1</td><td>number of API TCP workers</td>
                  <tr><td>CLUSTER_URL</td><td>tcp://localhost:5151</td><td>Internal server access URL for cluster communication</td>
                  <tr><td>CONFIG_DIR</td><td>BASE_DIR + /config</td><td>location of config files</td>
                  <tr><td>DB_LOCK_RETRIES</td><td>5</td><td>number of retries if a lock fails</td>
                  <tr><td>DB_LOCK_SLEEP</td><td>1000</td><td>milliseconds to wait before lock retry</td>
                  <tr><td>DB_OPTIONS</td><td>{&ltDB specific&gt}</td><td>See examples in ~/config/mail.js</td>
                  <tr><td>DB_SCOPE</td><td>dev:</td><td>Prefix for all DB keys - allows multiple ShellyJS instances to use same DB</td>
                  <tr><td>DB_WRAPPER</td><td>/Users/scott/git/shellyjs/lib/db/shsqlite.js</td><td>DB to use</td>
                  <tr><td>DEFAULT_ADMIN_NAME</td><td>shelly</td><td>User name for defaulit admin - created only if doesn't exist</td>
                  <tr><td>DEFAULT_ADMIN_PASSWORD</td><td>shelly</td><td>Password for default admin</td>
                  <tr><td>DNS_NAME</td><td>localhost</td><td>External server name that clients use</td>
                  <tr><td>EMAIL_DEFAULT_FROM</td><td>Game Shelly <shelly@gameshelly.com></td><td>From field in email header</td>
                  <tr><td>EMAIL_NOSEND</td><td>true</td><td>Dequeue but do not send emails (used for testing)</td>
                  <tr><td>EMAIL_QUEUE</td><td>true</td><td>Queue emails for sending - false sends synchronous</td>
                  <tr><td>EMAIL_QUEUE_RETRIES</td><td>2</td><td>how many times to resend on failure</td>
                  <tr><td>EMAIL_SENDTO</td><td>scott@lgdales.com</td><td>send all emails to this address (for testing)</td>
                  <tr><td>EMAIL_TRANSPORT</td><td>SMTP</td><td>SMTP or SES</td>
                  <tr><td>EMAIL_TRANSPORT_SERVICE</td><td>{}</td><td>transport specific options</td>
                  <tr><td>FAKE_SESSION_HASH</td><td>XXXX</td><td>user session hash that is always valid (for testing)</td>
                  <tr><td>FAKE_SESSION_ON</td><td>false</td><td>allow the fake session hash</td>
                  <tr><td>GAMES_API_DIR</td><td>/Users/scott/git/shellyjs/example/games</td><td>location of server side game APIs</td>
                  <tr><td>GAMES_PORT</td><td>5102</td><td>port for the example game web server</td>
                  <tr><td>GAMES_URL</td><td>http:// + DNS_NAME + : + GAMES_PORT</td><td>url for clients to access example games</td>
                  <tr><td>HEART_BEAT</td><td>30000</td><td>keep alive message interval for WebSocket and TCP interfaces</td>
                  <tr><td>LOGIN_PRIVATE_KEY</td><td>&ltuuid string&gt</td><td>uuid for login password hash</td>
                  <tr><td>LOG_CONSOLE_OPTS</td><td>{}</td><td>winston options for console logging</td>
                  <tr><td>LOG_FILE_OPTS</td><td>{}</td><td>winston optinos for file logging</td>
                  <tr><td>LOG_HOOK</td><td>function (winston) {
                      winston.add(winston.transports.Console, global.C.LOG_CONSOLE_OPTS);
                      winston.add(winston.transports.File, global.C.LOG_FILE_OPTS);
                      }</td><td>hook called after winston init to set any options</td>
                  <tr><td>LOG_MODULES</td><td>{"&lttype&gt":1}</td><td>types of messages to log (1 on, 0 off) - first param of shlog.info("&lttype&gr",...)</td>
                  <tr><td>MATCHER_INTERVAL</td><td>3000</td><td>milliseconds between match queue checks</td>
                  <tr><td>MODULE_CACHE</td><td>false</td><td>true if API modules are cached, false if they are reloaded each call (used for dev)</td>
                  <tr><td>REG_ALLOW_ANONYMOUS</td><td>true</td><td>should reg.anonymous be enabled or not</td>
                  <tr><td>REG_RESET_URL</td><td>http:// + DNS_NAME + : + GAMES_PORT + /reg/reset.html</td><td>url for password reset email</td>
                  <tr><td>REST_PORT</td><td>5101</td><td>port for rest server</td>
                  <tr><td>REST_URL</td><td>http:// + DNS_NAME + : + REST_PORT + /api</td><td>url for clients to access rest server</td>
                  <tr><td>SERVER_TAG_FN</td><td>~/shellyjs/example/config/server.json</td><td>location of servers uuid - created on first run</td>
                  <tr><td>SESSION_PRIVATE_KEY</td><td>&ltuuid string&gt</td><td>uuid for users session hash</td>
                  <tr><td>SESSION_TIMEOUT</td><td>0</td><td>seconds session should be valid - 0 is infinit</td>
                  <tr><td>SOCKET_PORT</td><td>5110</td><td>port used for WebSocket server</td>
                  <tr><td>SOCKET_URL</td><td>ws:// + DNS_NAME + : + SOCKET_PORT</td><td>url for clients to access WebSocket server</td>
                  <tr><td>TCP_PORT</td><td>5111</td><td>port used for TCP server</td>
                  <tr><td>TCP_URL</td><td>tcp:// + DNS_NAME + : + TCP_PORT</td><td>url for clients to access TCP server</td>

                  </tbody>
              </table>

              <p>There are two classes of APIs - Core and App.  The API definitions and capabilities are identical.  The
                 purpose of the segmentation is mostly to facilitate code separation for upgrades.
              </p>
              <h4>Core APIs</h4>
              <p>These contain basic functionality such as registration, counters, basic game play, and others.  They
                  ship with Shelly and are located in:<p>
              <div class="alert alert-info">
                  ~/node_modules/shellyjs/apis/
              </div>
              <p>They can be viewed in the admin via the "Core APIs" menu:
                  <a href="http://localhost:5100/core.html">http://localhost:5100/core.html</a>
              </p>
              <h4>App APIs</h4>
              <p>These are the developer defined APIs and are located in the <strong>APP_API_DIR</strong> config setting<p>
<pre class="prettyprint linenums">
shelly.start({
  APP_API_DIR: __dirname + "/apis",
});
</pre>
              <p>They can be viewed in the admin via the "App APIs" menu:
                  <a href="http://localhost:5100/core.html?api=api.app">http://localhost:5100/core.html?api=api.app</a>
              </p>
              <div class="alert alert-info">
                  NOTE: <strong>APP_API_DIR</strong> defaults to the ~/node_modules/shellyjs/example/apis directory.
              </div>

              <h4>App Definitions</h4>
              Shelly looks for any files in the APP_API_DIR with the flowing format:
              <div class="alert alert-info">
                  ~/apis/&ltAPI name&gt/&ltAPI name&gt.js
              </div>

          </section>



        <!-- Create API
        ================================================== -->
        <section id="createApi">
            <div class="page-header">
                <h1>Create an API <small></small></h1>
            </div>
            <h3>App Setup</h3>
            <h4>Follow the quick start to make sure Shelly is installed property</h4>
            <p><a href="/docs/index.html">Quick Start</a></p>
            <div class="alert alert-info">
                NOTE: By default Shelly will use a developer data store (sqlite).  This is intended for ease of setup and
                should be changed for any production environment.
            </div>
            <h4>Create your own Shelly App:</h4>
            <pre class="prettyprint lang-bash">$ cp ~/node_modules/shellyjs/example/* .</pre>
            <p>This will create the flowing</p>
            <pre>
                ./app.js - mail application file
                ./apis - directory where to place your APIs
                ./apis/example/example.js - example api to be used as a template
                ./games - directoy used by the Games Core API</pre>
            <h4>Run your own app:</h4>
            <pre class="prettyprint lang-bash">$ node app.js</pre>

        </section>

        <!-- Test API
        ================================================== -->
          <section id="testApi">
              <div class="page-header">
                  <h1>Test the API</h1>
              </div>
              <h4>Test your setup:</h4>
              <ol>
                  <li>
                      Lauch the admin test page: <a href="http://localhost:5100/core.html?api=api.app">http://localhost:5100/core.html?api=api.app</a>
                  </li>
                  <li>
                      Click the "example" API in the accordian to the left, then click the "hello" function below it.
                  </li>
                  <li>
                      To invoke the function click the "call function" button.
                  </li>
                  <li>
                      Try the "echo" function and alert the calling JSON by filling in the "param1" data member.
                  </li>
              </ol>
          </section>

          <section id="addFunction">
              <div class="page-header">
                  <h1>Add a function</h1>
              </div>
              <h4>Add a function description:</h4>
              <p>To allow for parameter, security and easy testing each API function has a description member in the
                  &ltmodule&gt.functions object</p>
              <p>Edit the file ~/apis/example/example.js</p>
<pre class="prettyprint linenums">
var sh = require(global.C.BASE_DIR + "/lib/shutil.js");

var example = exports;

example.desc = "example api";
example.functions = {
  echo: {desc: "one parameter api example", params: {param1: {dtype: "string"}}, security: []},
  hello: {desc: "my first api function", params: {param1: {dtype: "string"}}, security: []}
};

example.echo = function (req, res, cb) {
  res.add(sh.event("example.echo", req.body.param1));
  return cb(0);
};
</pre>
              <p>In the above code sample line 8 has been added to define the "hello" function in the "example" api</p>

              <h4>Add a function definition:</h4>
              <p>Now just create the function to be called with the fixed signature of function(req, res, cb)</p>
              <p>Edit the file ~/apis/example/example.js</p>
<pre class="prettyprint linenums">
var sh = require(global.C.BASE_DIR + "/lib/shutil.js");

var example = exports;

example.desc = "example api";
example.functions = {
  echo: {desc: "one parameter api example", params: {param1: {dtype: "string"}}, security: []},
  hello: {desc: "my first api function", params: {myName: {dtype: "string"}}, security: []}
};

example.echo = function (req, res, cb) {
  res.add(sh.event("example.echo", req.body.param1));
  return cb(0);
};

example.hello = function (req, res, cb) {
  res.add(sh.event("example.hello", "hello " + req.body.myName + "!"));
  return cb(0);
};
</pre>
              <p>In the above code sample lines 16-19 define the new function "hello" in the "example" API</p>
              <p>This function is now callable from the HTTP, WebSocket, and TCP interface.</p>
              <p>The <strong>req</strong> and <strong>res</strong> objects are similar to the express <strong>req</strong>
                 and <strong>res</strong> objects, but work for WebSockets and TCP also.</p>
              <p>You can add multiple response objects.  Moreover you can call <strong>res.add()</strong> multiple times in a single
              call.  The HTTP interface returns an array objects, while the WebSocket and TCP interface return each individual object.</p>
              <p>The <strong>sh.event</strong> function on line 12 and line 17 is just a convenience function that creates a standard
              envelope around each response.  It creates an object like:</p>
<pre class="prettyprint linenums">
{
  "event": "example.echo",
  "ts": 1378189438607,
  "data": "foo"
}
</pre>

          </section>



          <!-- Run Cluster
          ================================================== -->
          <section id="runCluster">
              <div class="page-header">
                  <h1>Run a two server cluster</h1>
              </div>

              <h3>Cluster configuration</h3>
              <h4>Per Server Workers</h4>
              <p>Each server in a cluster can run multiple workers for the HTTP, WebSocket, TCP, Admin, Game, Mailer, and Matcher processes.
                  These are configured per server in with the <strong>CLUSTER_NUM_*</strong>settings</p>
<pre class="prettyprint linenums">
global.CDEF("CLUSTER_NUM_SOCKET", 2);
global.CDEF("CLUSTER_NUM_TCP", 1);
global.CDEF("CLUSTER_NUM_REST", 1);
global.CDEF("CLUSTER_NUM_ADMIN", 1);
global.CDEF("CLUSTER_NUM_GAMES", 1);
global.CDEF("CLUSTER_NUM_MATCHER", 1);
global.CDEF("CLUSTER_NUM_MAILER", 1);
</pre>
              <p>In the above example the server will spawn 2 WebSocket workers and one each for the HTTP, TCP, Admin,
                  Games, Matcher, and Mailer worker types.</p>
              <h4>Multi-server - developer</h4>
              <p>Servers in a cluster register themselves on startup and can be added and removed dynamically.</p>
              <p>To demonstrate clustering in the development environment (sqlite) you can launch a second server
                  on the same machine by creating a different config file so the listening ports do not conflict.</p>
              <p>Both servers must have access to he same sqlite database file.</p>
              <p>The following example can be found in the ~/node_modules/shelly/examples/config2 directory:</p>
<pre class="prettyprint linenums lang-js">
global.CDEF("ADMIN_PORT", 6100);
global.CDEF("REST_PORT", 6101);
global.CDEF("GAMES_PORT", 6102);
global.CDEF("SOCKET_PORT", 6110);
global.CDEF("TCP_PORT", 6111);

global.CDEF("CLUSTER_URL", "tcp://localhost:6151");
// don't run a mail queue processor on this server
global.CDEF("CLUSTER_NUM_MAILERS", 0);

// pick up all the other default configs
require(global.C.BASE_DIR + "/config/main.js");
</pre>
              <h3>Start the first server</h3>
              <p>This assumes you have already copied the examples directory as done in the <a href="#createApi">Create API</a> section</p>
<pre class="prettyprint linenums lang-bash">
$ node app.js
</pre>
              <h3>Start the second server</h3>
              <p>The default first argument is a valid config directory with a main.js in it.</p>
<pre class="prettyprint linenums lang-bash">
$ node app.js CONFIG_DIR=./config2
</pre>

              <h3>Check the servers</h3>
              <ol>
                  <li>Login to the first server: http://localhost:5102/</li>
                  <li>Login to the second server: http://localhost:6102/</li>
                  <li>Go to the admin http://localhost:5100</li>
                  <li>In the admin go to the "Core APIs" and click on the "cluster" API and the "servers" function</li>
                  <li>Click the "call function button" and you should see two servers listed.</li>
              </ol>
<pre class="prettyprint linenums lang-bash">
[
  {
    "event": "cluster.servers",
    "ts": 1378193108072,
    "data": {
      "5c3817f0-d7a2-11e2-964f-d147e3ee063a": {
        "clusterUrl": "tcp://localhost:6151",
        "socketUrl": "ws://localhost:6110",
        "oid": "5c3817f0-d7a2-11e2-964f-d147e3ee063a",
        "created": 1378193106281,
        "modified": 1378193106282
      },
      "a81f9560-dac9-11e2-8aa4-7b114762795c": {
        "clusterUrl": "tcp://localhost:5151",
        "socketUrl": "ws://localhost:5110",
        "oid": "a81f9560-dac9-11e2-8aa4-7b114762795c",
        "created": 1378109876920,
        "modified": 1378109876921
      }
    }
  }
]
</pre>

              <h4>Multi-server - two machines</h4>
              <p>
                  To run a cluster on separate machines the Redis data store wrapper must be used by setting the
                  <strong>DB_WRAPPER</strong> and <strong>DB_OPTIONS</strong> in the "example/config/main.js".  For more details
                  see <a href="#useRedis">Use Redis</a>
              </p>
<pre class="prettyprint linenums lang-js">
global.CDEF("DB_WRAPPER", global.C.BASE_DIR + "/lib/db/shredis.js");
global.CDEF("DB_OPTIONS", {port: 6379, host: "127.0.0.1"});
</pre>
              <p>Then just install and start a server on each machine.</p>
<pre class="prettyprint linenums">
$ node app.js
</pre>

          </section>


          <!-- Run Cluster
          ================================================== -->
          <section id="useRedis">
              <div class="page-header">
                  <h1>Use Redis Datastore</h1>
              </div>

              <h4>Install Redis</h4>
              <p>Use the setup for your platform at Redis.io <a href="http://redis.io">Redis Install</a></p>
              <h4>Change Configuration</h4>
              <p>Add the following settings to the application configuration file in example/config/main.js</p>
<pre class="prettyprint linenums lang-js">
global.CDEF("DB_WRAPPER", global.C.BASE_DIR + "/lib/db/shredis.js");
global.CDEF("DB_OPTIONS", {port: 6379, host: "127.0.0.1"});
</pre>
              <p>By default Redis installs with no password required.  Use the <strong>DB_OPTIONS</strong> to pass in any
              Redis specific settings.  Shelly uses the Redis client.  Details for this client can be found at the
              <a href="https://github.com/mranney/node_redis">Redis client GitHub repo</a>.</p>

              <div class="alert alert-info">
                  NOTE: If <strong>host</strong> and <strong>port</strong> are set in the <strong>DB_OPTIONS</strong> configuration,
                  the values are passed as the first and second parameters to redis.createClient(host, port. options).  Also redis.auth is called
                  if a <strong>password</strong> member is set.
              </div>

              <p>If your Redis server has a password required your configuration will look something like:</p>
<pre class="prettyprint linenums lang-js">
global.CDEF("DB_WRAPPER", global.C.BASE_DIR + "/lib/db/shredis.js");
global.CDEF("DB_OPTIONS", {port: 6379, host: "127.0.0.1", password:"foo"});
</pre>

              <h4>Check the access</h4>
              <ol>
                  <li>Go to the admin http://localhost:5100</li>
                  <li>In the admin go to the "System" page</li>
                  <li>Verify the DB_WRAPPER and DB_OPTIONS are set correctly</li>
              </ol>
          </section>

      </div>
    </div>

  </div>


    <!-- Footer
    ================================================== -->
    <footer class="footer">
      <div class="container">
        <p>Designed and built with all the love in the world by <a href="http://twitter.com/mdo" target="_blank">@mdo</a> and <a href="http://twitter.com/fat" target="_blank">@fat</a>.</p>
        <p>Code licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License v2.0</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
        <p><a href="http://glyphicons.com">Glyphicons Free</a> licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
        <ul class="footer-links">
          <li><a href="http://blog.getbootstrap.com">Blog</a></li>
          <li class="muted">&middot;</li>
          <li><a href="https://github.com/twbs/bootstrap/issues?state=open">Issues</a></li>
          <li class="muted">&middot;</li>
          <li><a href="https://github.com/twbs/bootstrap/releases">Changelog</a></li>
        </ul>
      </div>
    </footer>



  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="/common/google-code-prettify/prettify.js"></script>
  <script src="/common/bootstrap/js/jquery.js"></script>
  <script src="/common/bootstrap/js/bootstrap.js"></script>

<script>
    $(function(){
    var $window = $(window)
    prettyPrint();

    // side bar
    setTimeout(function () {
    $('.bs-docs-sidenav').affix({
    offset: {
    top: function () { return $window.width() <= 980 ? 290 : 210 }
    , bottom: 270
    }
    })
    }, 100)
    });
</script>

    <!-- Analytics
    ================================================== -->
    <script>
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '4f0dc9fef5a1f55508000013');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>

  </body>
</html>
